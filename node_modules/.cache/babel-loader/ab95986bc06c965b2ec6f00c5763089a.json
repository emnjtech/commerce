{"ast":null,"code":"import _slicedToArray from\"/Users/admin/ReactProjects/reactProject/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{ADD_T0_CART,REMOVE_FROM_CART,INC_QTY,DEC_QTY,EMPTY_CART}from\"./commerce-action\";import{useReducer,useEffect,useState}from\"react\";import CommerceContext from\"./commerce-context\";import{commerceReducer}from'./commerce-reducer';import{signInWithPopup,onAuthStateChanged,signOut}from'firebase/auth';import{auth,provider}from'../firebaseConfig';import{jsx as _jsx}from\"react/jsx-runtime\";var storageKey=\"localCart\";var InitialState={basket:[]//id, title,price,image\n};// add to cart\nexport default function CommerceState(props){var _useReducer=useReducer(commerceReducer,InitialState,function(initial){return JSON.parse(localStorage.getItem(storageKey))||initial;}),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),currUser=_useState2[0],setCurrUser=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userInfo=_useState4[0],setUserInfo=_useState4[1];useEffect(function(){var unsubscribe=onAuthStateChanged(auth,function(currentuser){setCurrUser(currentuser);});return function(){return unsubscribe();};},[currUser]);var signInWithGoogle=function signInWithGoogle(){signInWithPopup(auth,provider).then(function(result){localStorage.setItem('USER_INFORMATION',JSON.stringify(result.user.displayName));window.location.reload(true);}).catch(function(error){alert(error);});};/*useEffect(() => {\n        localStorage.setItem('USER_INFORMATION', JSON.stringify(userInfo));\n        console.log(userInfo)\n\n    }, [userInfo]);\n*/useEffect(function(){var data=JSON.parse(localStorage.getItem('USER_INFORMATION'));if(data!==null)setUserInfo(data);setUserInfo(data);},[userInfo]);var userLogout=function userLogout(){return signOut(auth);};var incQty=function incQty(itemID){dispatch({type:INC_QTY,payload:itemID});};useEffect(function(){localStorage.setItem(storageKey,JSON.stringify(state));},[state]);var totalQty=state.basket.reduce(function(totalQty,item){return totalQty+item.qty;},0);var decQty=function decQty(itemID){dispatch({type:DEC_QTY,payload:itemID});};var addToCart=function addToCart(item){dispatch({type:ADD_T0_CART,payload:item});};var removeFromCart=function removeFromCart(itemId){dispatch({type:REMOVE_FROM_CART,payload:itemId});};var emptyCart=function emptyCart(){dispatch({type:EMPTY_CART});};return/*#__PURE__*/_jsx(CommerceContext.Provider,{value:{basket:state.basket,addToCart:addToCart,removeFromCart:removeFromCart,incQty:incQty,decQty:decQty,emptyCart:emptyCart,totalQty:totalQty,currUser:currUser,signInWithGoogle:signInWithGoogle,userLogout:userLogout,userInfo:userInfo},children:props.children});}","map":{"version":3,"sources":["/Users/admin/ReactProjects/reactProject/my-app/src/context/commerce-state.js"],"names":["React","ADD_T0_CART","REMOVE_FROM_CART","INC_QTY","DEC_QTY","EMPTY_CART","useReducer","useEffect","useState","CommerceContext","commerceReducer","signInWithPopup","onAuthStateChanged","signOut","auth","provider","storageKey","InitialState","basket","CommerceState","props","initial","JSON","parse","localStorage","getItem","state","dispatch","currUser","setCurrUser","userInfo","setUserInfo","unsubscribe","currentuser","signInWithGoogle","then","result","setItem","stringify","user","displayName","window","location","reload","catch","error","alert","data","userLogout","incQty","itemID","type","payload","totalQty","reduce","item","qty","decQty","addToCart","removeFromCart","itemId","emptyCart","children"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { ADD_T0_CART, REMOVE_FROM_CART, INC_QTY, DEC_QTY, EMPTY_CART, } from \"./commerce-action\";\nimport { useReducer, useEffect,useState} from \"react\";\nimport CommerceContext from \"./commerce-context\";\nimport {commerceReducer} from './commerce-reducer'\nimport { signInWithPopup, onAuthStateChanged, signOut } from 'firebase/auth'\nimport {auth,provider} from '../firebaseConfig'\nconst storageKey = \"localCart\";\n\nconst InitialState = {\n    basket: [], //id, title,price,image\n}\n\n\n// add to cart\n\n\n\nexport default function CommerceState(props) {\n    const [state, dispatch] = useReducer(commerceReducer, InitialState, (initial) => JSON.parse(localStorage.getItem(storageKey)) || initial)\n    const [currUser, setCurrUser] = useState({})\n    const [userInfo, setUserInfo] = useState(\"\")\n    \n\n     useEffect(() => {\n        const unsubscribe = onAuthStateChanged(auth, (currentuser) => {\n   \n                setCurrUser(currentuser)   \n        })\n              \n         return () => unsubscribe()     \n    },[currUser]) \n    \nconst signInWithGoogle = () => {\n        signInWithPopup(auth, provider)\n            .then((result) => {\n                localStorage.setItem('USER_INFORMATION', JSON.stringify(result.user.displayName));\n                window.location.reload(true)\n                   \n                })\n              \n            .catch((error) => {\n                alert(error)\n            })\n    }  \n\n    /*useEffect(() => {\n        localStorage.setItem('USER_INFORMATION', JSON.stringify(userInfo));\n        console.log(userInfo)\n\n    }, [userInfo]);\n*/\n    useEffect(() => {\n        const data = JSON.parse(localStorage.getItem('USER_INFORMATION'));\n        if (data !== null) setUserInfo(data);\n        setUserInfo(data)\n        \n\n    }, [userInfo]);\n    \n\n\n    const userLogout = () => {\n        return signOut(auth)\n    }\n    const incQty = (itemID) => {\n        dispatch({\n            type: INC_QTY,\n            payload: itemID\n        })\n    }\n\n    useEffect(() => {\n        localStorage.setItem(storageKey, JSON.stringify(state));\n        \n    }, [state]);\n\n    const totalQty = state.basket.reduce((totalQty, item) => {\n        return totalQty + (item.qty)\n    }, 0)\n\n\n\n    const decQty = (itemID) => {\n        dispatch({\n            type: DEC_QTY,\n            payload:itemID\n            \n        })\n    }\n    const addToCart = (item) => {\n        dispatch({\n            type: ADD_T0_CART,\n            payload: item\n\n        })\n    }\n\n    const removeFromCart = (itemId) => {\n        dispatch({\n            type: REMOVE_FROM_CART,\n            payload: itemId\n        })\n    }\n\n    const emptyCart = () => {\n        dispatch({\n            type:EMPTY_CART\n        })\n    }\n\n  return (\n   \n      <CommerceContext.Provider value={{\n          basket: state.basket,\n          addToCart,\n          removeFromCart,\n          incQty,\n          decQty,\n          emptyCart,\n          totalQty,\n          currUser,\n          signInWithGoogle,\n          userLogout,\n          userInfo\n\n      }}>\n          {props.children}\n      </CommerceContext.Provider>\n      \n      \n      \n  )\n}\n"]},"metadata":{},"sourceType":"module"}